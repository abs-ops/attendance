# 1、概述

&emsp;&emsp;考勤系统是公司施小宝产品平台下负责考勤业务管理的一个子系统，系统立足于公司大平台，面向企业考勤业务，架构起整个企业考勤机网络系统，可以对企业各部门员工实现7*24小时方位无死角考勤。下面这幅图是展示了考勤系统在整个平台中的位置。


![考勤系统在施小宝平台中的位置概览](/assets/image/20170808114448.png "考勤系统在施小宝平台中的位置概览")




# 2、业务架构

## 2.1、概述

&emsp;&emsp;考勤系统目前提供两大块内容：1、实现企业考勤管理。2、实现企业LED广告投放。

## 2.2、企业考勤管理

&emsp;&emsp;可以实现对企业各部门管辖的工作人员在各时间段实施差异化考勤管理。

## 2.3、企业LED广告投放管理

&emsp;&emsp;可以实现对企业各部门管辖的LED设备各时间段投放的广告内容实施管理。


# 3、技术架构

&emsp;&emsp;针对考勤系统整体需求特点，技术实现上，我们将考勤系统划分为考勤应用系统(简称考勤系统,attendance-app)、考勤硬件网关系统(简称硬件网关,attendance-device)。两者关系如下图所示。

![考勤业务架构概览](/assets/image/20170808145254.png "考勤业务架构概览")

## 3.1、考勤应用系统

&emsp;&emsp;考勤应用系统是整个考勤系统的系统中枢，它通过消息队列将操作指令下发给硬件网关系统，并通过消息队列获取硬件网关系统转发过来的考勤流水记录、设备状态信息。

&emsp;&emsp;考勤应用系统接收到硬件网关系统转发过来的考勤流水记录后，经过考勤规则过滤层清洗后，进入有效考勤记录数据库中，方便企业实时获取这些考勤信息，也可以在考勤信息清洗完成时实时通知给相关部门的管理人员。

&emsp;&emsp;考勤应用系统接收到硬件网关系统转发过来的设备状态信息后，实时存储到时序数据库，运维监控系统可以实时监测设备的运行状态是否良好。

&emsp;&emsp;管理人员可以根据企业各部门的具体业务需要定制不同的考勤规则，考勤系统系统会将部门-人员身份证对应信息下发到硬件网关，网关进而将这些信息下发到中控设备辖区的特定考勤机上。

&emsp;&emsp;管理人员可以根据企业部门具体业务需要定制各部门辖区内的LED设备所投放的广告信息内容，考勤系统会将部门-LED对应信息下发到硬件网关，硬件网关进而通过中控设备将广告信息投放到指定的LED设备上。

&emsp;&emsp;管理人员可以在考勤系统上实时获取到自己部门内部员工的的考勤信息。

&emsp;&emsp;管理人员可以在考勤系统上实时获取到自己部门管辖范围内的考勤机、LED设备的在线状态信息。


## 3.2、考勤硬件网关系统

&emsp;&emsp;硬件网关是所有中控设备的中枢，人脸母版信息、来自考勤应用系统的信息都会被存储在硬件网关系统的附属Mongodb中，硬件网关系统根据实际需要会将匹配的信息下发到被中控设备管辖的考勤机、LED上。 

&emsp;&emsp;附属于硬件网关的Redis中存储着设备状态信息、设备网络路由信息等。 

&emsp;&emsp;硬件网关会将考勤记录信息通过消息队列(MQ)实时发送给考勤系统。 
